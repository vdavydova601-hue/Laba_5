Загаловочный файл theater_db.h:
#ifndef THEATER_DB_H
#define THEATER_DB_H

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_NAME 100
#define FILENAME "theater.txt"


typedef struct Record {
    int id;                     
    int day, month, year;       
    int hour, minute;           
    char show[MAX_NAME];        
    int row;                    
    int seat;                   
    struct Record* next;        
} Record;


Record* create_list();
void free_list(Record* head);
Record* add_record(Record* head, int* next_id);
Record* remove_record(Record* head, int id);
Record* find_by_id(Record* head, int id);
void print_all(Record* head);
void save_to_file(Record* head);
Record* load_from_file(int* next_id);

#endif





Работа с билетами и данных о покупателях, создание меню theater_db.c :
#include "theater_db.h"


Record* create_record(int id, int d, int m, int y, int hr, int min, 
                     const char* show, int r, int s) {
    Record* new = (Record*)malloc(sizeof(Record));
    if (new) {
        new->id = id;
        new->day = d; new->month = m; new->year = y;
        new->hour = hr; new->minute = min;
        strncpy(new->show, show, MAX_NAME-1);
        new->row = r;
        new->seat = s;
        new->next = NULL;
    }
    return new;
}


Record* add_record(Record* head, int* next_id) {
    int d, m, y, hr, min, r, s;
    char show[MAX_NAME];
    
    printf("Дата (д м г): "); scanf("%d %d %d", &d, &m, &y);
    printf("Время (ч м): "); scanf("%d %d", &hr, &min);
    printf("Спектакль: "); getchar(); fgets(show, MAX_NAME, stdin);
    show[strcspn(show, "\n")] = 0;
    printf("Ряд и место: "); scanf("%d %d", &r, &s);
    
    Record* new = create_record((*next_id)++, d, m, y, hr, min, show, r, s);
    
    if (!head) return new;
    
    Record* current = head;
    while (current->next) current = current->next;
    current->next = new;
    return head;
}

Record* remove_record(Record* head, int id) {
    if (!head) return NULL;
    
    if (head->id == id) {
        Record* temp = head->next;
        free(head);
        return temp;
    }
    
    Record* current = head;
    while (current->next && current->next->id != id) {
        current = current->next;
    }
    
    if (current->next) {
        Record* to_delete = current->next;
        current->next = to_delete->next;
        free(to_delete);
    }
    
    return head;
}


Record* find_by_id(Record* head, int id) {
    Record* current = head;
    while (current && current->id != id) {
        current = current->next;
    }
    return current;
}


void print_all(Record* head) {
    if (!head) {
        printf("База пуста\n");
        return;
    }
    
    printf("ID\tДата\t\tВремя\tСпектакль\t\tРяд\tМесто\n");
    printf("------------------------------------------------------------\n");
    
    Record* current = head;
    while (current) {
        printf("%d\t%02d.%02d.%d\t%02d:%02d\t%-20s\t%d\t%d\n",
               current->id,
               current->day, current->month, current->year,
               current->hour, current->minute,
               current->show,
               current->row, current->seat);
        current = current->next;
    }
}


void save_to_file(Record* head) {
    FILE* file = fopen(FILENAME, "w");
    if (!file) return;
    
    Record* current = head;
    while (current) {
        fprintf(file, "%d %d %d %d %d %d %s %d %d\n",
                current->id,
                current->day, current->month, current->year,
                current->hour, current->minute,
                current->show,
                current->row, current->seat);
        current = current->next;
    }
    
    fclose(file);
    printf("Сохранено\n");
}


Record* load_from_file(int* next_id) {
    FILE* file = fopen(FILENAME, "r");
    if (!file) return NULL;
    
    Record* head = NULL;
    Record* tail = NULL;
    *next_id = 1;
    
    int id, d, m, y, hr, min, r, s;
    char show[MAX_NAME];
    
    while (fscanf(file, "%d %d %d %d %d %d %s %d %d",
                  &id, &d, &m, &y, &hr, &min, show, &r, &s) == 9) {
        Record* new = create_record(id, d, m, y, hr, min, show, r, s);
        
        if (!head) {
            head = new;
            tail = new;
        } else {
            tail->next = new;
            tail = new;
        }
        
        if (id >= *next_id) *next_id = id + 1;
    }
    
    fclose(file);
    return head;
}


void free_list(Record* head) {
    Record* current = head;
    while (current) {
        Record* next = current->next;
        free(current);
        current = next;
    }
}





Оснавная работа с меню main.c :
#include "theater_db.h"

void print_menu() {
    printf("\n=== ТЕАТР ===\n");
    printf("1. Показать все\n");
    printf("2. Добавить\n");
    printf("3. Найти по ID\n");
    printf("4. Поиск по ряду и месту\n");
    printf("5. Удалить\n");
    printf("6. Сохранить\n");  
    printf("0. Выход\n");      
    printf("Выбор: ");
}

void search_by_seat(Record* head) {
    int target_row, target_seat;
    
    printf("\n=== ПОИСК ПО РЯДУ И МЕСТУ ===\n");
    printf("Введите ряд для поиска: ");
    scanf("%d", &target_row);
    printf("Введите место для поиска: ");
    scanf("%d", &target_seat);
    
    Record* current = head;
    int found_count = 0;
    
    printf("\nРезультаты поиска (Ряд %d, Место %d):\n", target_row, target_seat);
    printf("------------------------------------------------\n");
    
    while (current != NULL) {
        if (current->row == target_row && current->seat == target_seat) {
            printf("ID: %d\n", current->id);
            printf("Дата: %02d.%02d.%d\n", 
                   current->day, current->month, current->year);
            printf("Время: %02d:%02d\n", 
                   current->hour, current->minute);
            printf("Спектакль: %s\n", current->show);
            printf("---\n");
            found_count++;
        }
        current = current->next;
    }
    
    if (found_count == 0) {
        printf("Записей не найдено\n");
    } else {
        printf("Найдено записей: %d\n", found_count);
    }
}

int main() {
    Record* database = NULL;
    int next_id = 1;
    int choice;

    database = load_from_file(&next_id);
    if (database) {
        printf("Данные загружены из файла '%s'\n", FILENAME);
    } else {
        printf("Файл '%s' не найден. Создана новая база данных.\n", FILENAME);
    }
    
    do {
        print_menu();
        scanf("%d", &choice);
        
        // Очищаем буфер ввода
        while(getchar() != '\n');
        
        switch(choice) {
            case 1:  
                print_all(database);
                break;
                
            case 2:  
                database = add_record(database, &next_id);
                break;
                
            case 3: {  
                int id;
                printf("\n=== ПОИСК ПО ID ===\n");
                printf("Введите ID для поиска: ");
                scanf("%d", &id);
                
                Record* found = find_by_id(database, id);
                if (found) {
                    printf("\nНайдена запись:\n");
                    printf("ID: %d\n", found->id);
                    printf("Дата: %02d.%02d.%d\n", 
                           found->day, found->month, found->year);
                    printf("Время: %02d:%02d\n", 
                           found->hour, found->minute);
                    printf("Спектакль: %s\n", found->show);
                    printf("Ряд: %d, Место: %d\n", 
                           found->row, found->seat);
                } else {
                    printf("Запись с ID %d не найдена\n", id);
                }
                break;
            }
                
            case 4:  
                search_by_seat(database);
                break;
                
            case 5: { 
                int id;
                printf("\n=== УДАЛЕНИЕ ===\n");
                printf("Введите ID для удаления: ");
                scanf("%d", &id);
                database = remove_record(database, id);
                printf("Запись удалена (если существовала)\n");
                break;
            }
                
            case 6:  
                save_to_file(database);
                break;
                
            case 0:  
                printf("\nВыход из программы...\n");
                break;
                
            default:
                printf("\nНеверный выбор! Попробуйте снова.\n");
        }
        
        // Пауза для просмотра результатов (кроме выхода)
        if (choice != 0) {
            printf("\nНажмите Enter для продолжения...");
            getchar();
        }
        
    } while(choice != 0);
    

    save_to_file(database);
    free_list(database);
    
    printf("Данные сохранены в файл '%s'\n", FILENAME);
    return 0;
}




Сборка файлов Makefile :

all: theater

theater: main.o theater_db.o
 gcc -o theater main.o theater_db.o

main.o: main.c theater_db.h
 gcc -c main.c

theater_db.o: theater_db.c theater_db.h
 gcc -c theater_db.c

clean:
 rm -f *.o theater


